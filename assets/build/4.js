webpackJsonp([4],{236:function(l,n,u){"use strict";function a(l){return d._19(2,[d._16(402653184,1,{backdrop:0}),(l()(),d.Z(1,0,null,null,1,"div",[["class","menu-inner"]],null,null,null,null,null)),d._12(null,0),(l()(),d.Z(3,0,null,null,1,"ion-backdrop",[["disable-activated",""],["role","presentation"],["tappable",""]],null,null,null,null,null)),d.Y(4,16384,[[1,4]],0,Q.a,[d.j,d.z],null,null)],null,null)}function e(l){return d._19(0,[(l()(),d.Z(0,0,null,null,1,"div",[],null,null,null,null,null)),(l()(),d._18(1,null,["Ethereum account required to play. ",""]))],null,function(l,n){l(n,1,0,n.component.appState.accountStatus)})}function t(l){return d._19(0,[(l()(),d.Z(0,0,null,null,5,"div",[],null,null,null,null,null)),(l()(),d._18(-1,null,["\n        "])),(l()(),d.Z(2,0,null,null,0,"img",[["class","load-img load-grey"],["src","/assets/imgs/loading-grey.png"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n        "])),(l()(),d.Z(4,0,null,null,0,"img",[["class","load-img load-pink"],["src","/assets/imgs/loading-pink.png"]],[[4,"clip-path",null]],null,null,null,null)),(l()(),d._18(-1,null,["\n      "]))],null,function(l,n){l(n,4,0,n.component.loadingStyle)})}function o(l){return d._19(0,[(l()(),d.Z(0,0,null,null,21,"div",[],null,null,null,null,null)),(l()(),d._18(-1,null,["\n\n      "])),(l()(),d.Z(2,0,null,null,1,"div",[["class","chatbutton"]],null,[[null,"click"]],function(l,n,u){var a=!0;if("click"===n){a=!1!==l.component.toggleChat()&&a}return a},null,null)),(l()(),d._18(-1,null,["\n      "])),(l()(),d._18(-1,null,["\n\n      "])),(l()(),d.U(16777216,null,null,1,null,t)),d.Y(6,16384,null,0,I.i,[d.I,d.F],{ngIf:[0,"ngIf"]},null),(l()(),d._18(-1,null,["\n\n      "])),(l()(),d.Z(8,0,null,null,11,"div",[["id","canvaswindow"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n        "])),(l()(),d.Z(10,0,null,null,8,"div",[["class","webgl-content"],["id","canvaswrapper"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(12,0,null,null,0,"div",[["id","gameContainer"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(14,0,null,null,3,"div",[["class","footer"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n            "])),(l()(),d.Z(16,0,null,null,0,"div",[["class","fullscreen"]],null,[[null,"click"]],function(l,n,u){var a=!0;if("click"===n){a=!1!==l.component.goFull()&&a}return a},null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d._18(-1,null,["\n        "])),(l()(),d._18(-1,null,["\n      "])),(l()(),d._18(-1,null,["\n      "])),(l()(),d._18(-1,null,["\n    "]))],function(l,n){l(n,6,0,!n.component.gameLoaded)},null)}function i(l){return d._19(0,[(l()(),d.Z(0,0,null,null,25,"ion-row",[["class","row"]],null,null,null,null,null)),d.Y(1,16384,null,0,S.a,[],null,null),(l()(),d._18(-1,null,["\n        "])),(l()(),d.Z(3,0,null,null,5,"ion-col",[["class","col"],["col-12",""]],null,null,null,null,null)),d.Y(4,16384,null,0,k.a,[],null,null),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(6,0,null,null,1,"p",[],null,null,null,null,null)),(l()(),d._18(-1,null,["Waiting to join a game lobby"])),(l()(),d._18(-1,null,["\n        "])),(l()(),d._18(-1,null,["\n        "])),(l()(),d.Z(10,0,null,null,3,"ion-spinner",[["class","col"],["col-12",""],["ion-col",""]],[[2,"spinner-paused",null]],null,null,z.b,z.a)),d.Y(11,16384,null,0,k.a,[],null,null),d.Y(12,114688,null,0,F.a,[P.a,d.j,d.z],null,null),(l()(),d._18(-1,null,["\n        "])),(l()(),d._18(-1,null,["\n        "])),(l()(),d.Z(15,0,null,null,9,"div",[["class","swapping-squares-spinner"],["style","spinnerStyle"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(17,0,null,null,0,"div",[["class","square"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(19,0,null,null,0,"div",[["class","square"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(21,0,null,null,0,"div",[["class","square"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n          "])),(l()(),d.Z(23,0,null,null,0,"div",[["class","square"]],null,null,null,null,null)),(l()(),d._18(-1,null,["\n        "])),(l()(),d._18(-1,null,["\n      "]))],function(l,n){l(n,12,0)},function(l,n){l(n,10,0,d._13(n,12)._paused)})}function s(l){return d._19(0,[(l()(),d.Z(0,0,null,null,12,"ion-item",[["class","item item-block"]],null,null,null,U.b,U.a)),d.Y(1,1097728,null,3,L.a,[q.a,P.a,d.j,d.z,[2,G.a]],null,null),d._16(335544320,6,{contentLabel:0}),d._16(603979776,7,{_buttons:1}),d._16(603979776,8,{_icons:1}),d.Y(5,16384,null,0,M.a,[],null,null),(l()(),d._18(-1,2,["\n          "])),(l()(),d.Z(7,0,null,2,1,"span",[["class","username"]],null,null,null,null,null)),(l()(),d._18(8,null,["",":"])),(l()(),d._18(-1,2,["\n          "])),(l()(),d.Z(10,0,null,2,1,"span",[["class","message"]],null,null,null,null,null)),(l()(),d._18(11,null,["",""])),(l()(),d._18(-1,2,["\n        "]))],null,function(l,n){l(n,8,0,n.context.$implicit.username);l(n,11,0,n.context.$implicit.text)})}function c(l){return d._19(0,[(l()(),d.Z(0,0,null,null,5,"ion-list",[["class","chatbox"],["no-lines",""]],null,null,null,null,null)),d.Y(1,16384,null,0,T.a,[P.a,d.j,d.z,V.a,x.l,B.a],null,null),(l()(),d._18(-1,null,["\n        "])),(l()(),d.U(16777216,null,null,1,null,s)),d.Y(4,802816,null,0,I.h,[d.I,d.F,d.p],{ngForOf:[0,"ngForOf"]},null),(l()(),d._18(-1,null,["\n      "]))],function(l,n){l(n,4,0,n.component.msgs)},null)}function r(l){return d._19(0,[d._16(402653184,1,{chatcontent:0}),d._16(402653184,2,{content:0}),(l()(),d.Z(2,0,null,null,66,"ion-split-pane",[],null,null,null,null,null)),d.Y(3,4341760,null,1,E.b,[d.u,V.a,P.a,d.j,d.z],{when:[0,"when"]},null),d._16(603979776,3,{_setchildren:1}),d._15(2048,[[3,4]],E.a,null,[E.b]),(l()(),d._18(-1,null,["\n  "])),(l()(),d.Z(7,0,[["head",1]],null,6,"ion-header",[],null,null,null,null,null)),d.Y(8,16384,null,0,N.a,[P.a,d.j,d.z,[2,R.a]],null,null),(l()(),d._18(-1,null,["\n    "])),(l()(),d.Z(10,0,null,null,2,"ion-navbar",[["class","toolbar"]],[[8,"hidden",0],[2,"statusbar-padding",null]],null,null,D.b,D.a)),d.Y(11,49152,null,0,H.a,[W.a,[2,R.a],[2,O.a],P.a,d.j,d.z],null,null),(l()(),d._18(-1,3,["\n    "])),(l()(),d._18(-1,null,["\n  "])),(l()(),d._18(-1,null,["\n  "])),(l()(),d.Z(15,0,null,null,1,"header-component",[],null,null,null,A.b,A.a)),d.Y(16,49152,null,0,X.a,[O.a,_.a,d.u],null,null),(l()(),d._18(-1,null,["\n  "])),(l()(),d.Z(18,0,null,null,8,"ion-content",[["no-padding",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,$.b,$.a)),d.Y(19,4374528,[[2,4],["content",4]],0,J.a,[P.a,V.a,B.a,d.j,d.z,W.a,K.a,d.u,[2,R.a],[2,O.a]],null,null),(l()(),d._18(-1,1,["\n\n    "])),(l()(),d.U(16777216,null,1,1,null,e)),d.Y(22,16384,null,0,I.i,[d.I,d.F],{ngIf:[0,"ngIf"]},null),(l()(),d._18(-1,1,["\n    "])),(l()(),d.U(16777216,null,1,1,null,o)),d.Y(25,16384,null,0,I.i,[d.I,d.F],{ngIf:[0,"ngIf"]},null),(l()(),d._18(-1,1,["\n  "])),(l()(),d._18(-1,null,["\n\n  "])),(l()(),d.Z(28,0,null,null,39,"ion-menu",[["role","navigation"],["side","right"],["type","push"]],null,null,null,a,ul)),d.Y(29,278528,null,0,I.g,[d.p,d.q,d.j,d.A],{ngClass:[0,"ngClass"]},null),d._14(30,{moveMenu:0}),d.Y(31,245760,null,2,ll.a,[nl.a,d.j,P.a,V.a,d.z,K.a,x.l,B.a,W.a],{content:[0,"content"],type:[1,"type"],side:[2,"side"]},null),d._16(335544320,4,{menuContent:0}),d._16(335544320,5,{menuNav:0}),d._15(2048,[[3,4]],E.a,null,[ll.a]),(l()(),d._18(-1,0,["\n    "])),(l()(),d.Z(36,0,null,0,10,"ion-header",[],null,null,null,null,null)),d.Y(37,16384,null,0,N.a,[P.a,d.j,d.z,[2,R.a]],null,null),(l()(),d._18(-1,null,["\n      "])),(l()(),d.Z(39,0,null,null,6,"ion-toolbar",[["class","toolbar"]],[[2,"statusbar-padding",null]],null,null,al.b,al.a)),d.Y(40,49152,null,0,el.a,[P.a,d.j,d.z],null,null),(l()(),d._18(-1,3,["\n        "])),(l()(),d.Z(42,0,null,3,2,"ion-title",[],null,null,null,tl.b,tl.a)),d.Y(43,49152,null,0,ol.a,[P.a,d.j,d.z,[2,el.a],[2,H.a]],null,null),(l()(),d._18(-1,0,["Menu"])),(l()(),d._18(-1,3,["\n      "])),(l()(),d._18(-1,null,["\n    "])),(l()(),d._18(-1,0,["\n\n    "])),(l()(),d.Z(48,0,null,0,8,"ion-footer",[],null,null,null,null,null)),d.Y(49,16384,null,0,il.a,[P.a,d.j,d.z,[2,R.a]],null,null),(l()(),d._18(-1,null,["\n      "])),(l()(),d.Z(51,0,null,null,4,"ion-input",[["placeholder","Send a message"]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"keypress"]],function(l,n,u){var a=!0,e=l.component;if("ngModelChange"===n){a=!1!==(e.msg=u)&&a}if("keypress"===n){a=!1!==e.send(u.keyCode)&&a}return a},sl.b,sl.a)),d.Y(52,671744,null,0,cl.k,[[8,null],[8,null],[8,null],[8,null]],{model:[0,"model"]},{update:"ngModelChange"}),d._15(2048,null,cl.g,null,[cl.k]),d.Y(54,16384,null,0,cl.h,[cl.g],null,null),d.Y(55,5423104,null,0,rl.a,[P.a,V.a,q.a,W.a,d.j,d.z,[2,J.a],[2,L.a],[2,cl.g],B.a],{placeholder:[0,"placeholder"]},null),(l()(),d._18(-1,null,["\n    "])),(l()(),d._18(-1,0,["\n\n    "])),(l()(),d.Z(58,0,null,0,8,"ion-content",[["ion-scroll",""]],[[2,"statusbar-padding",null],[2,"has-refresher",null]],null,null,$.b,$.a)),d.Y(59,4374528,[[4,4],[2,4],[1,4],["chatcontent",4]],0,J.a,[P.a,V.a,B.a,d.j,d.z,W.a,K.a,d.u,[2,R.a],[2,O.a]],null,null),(l()(),d._18(-1,1,["\n\n      "])),(l()(),d.U(16777216,null,1,1,null,i)),d.Y(62,16384,null,0,I.i,[d.I,d.F],{ngIf:[0,"ngIf"]},null),(l()(),d._18(-1,1,["\n      "])),(l()(),d.U(16777216,null,1,1,null,c)),d.Y(65,16384,null,0,I.i,[d.I,d.F],{ngIf:[0,"ngIf"]},null),(l()(),d._18(-1,1,["\n    "])),(l()(),d._18(-1,0,["\n\n  "])),(l()(),d._18(-1,null,["\n"]))],function(l,n){var u=n.component;l(n,3,0,u.showChat);l(n,22,0,!u.appState.account);l(n,25,0,u.appState.account);l(n,29,0,l(n,30,0,"showChat"));l(n,31,0,d._13(n,19),"push","right");l(n,52,0,u.msg);l(n,55,0,"Send a message");l(n,62,0,!u.chatConnected);l(n,65,0,u.chatConnected)},function(l,n){l(n,10,0,d._13(n,11)._hidden,d._13(n,11)._sbPadding);l(n,18,0,d._13(n,19).statusbarPadding,d._13(n,19)._hasRefresher);l(n,39,0,d._13(n,40)._sbPadding);l(n,51,0,d._13(n,54).ngClassUntouched,d._13(n,54).ngClassTouched,d._13(n,54).ngClassPristine,d._13(n,54).ngClassDirty,d._13(n,54).ngClassValid,d._13(n,54).ngClassInvalid,d._13(n,54).ngClassPending);l(n,58,0,d._13(n,59).statusbarPadding,d._13(n,59)._hasRefresher)})}Object.defineProperty(n,"__esModule",{value:!0});var d=u(0),g=(u(5),u(39),u(28)),_=u(25),p=function(){function l(l,n,u,a,e,t){this.navCtrl=l,this.navParams=n,this.appState=u,this.menuCtrl=a,this.events=e,this.sanitizer=t,this.gameLoaded=!1,this.msgs=[],this.noAccount=!1,this.showChat=!1,this.chatConnected=!1,this.loadingStyle=this.sanitizer.bypassSecurityTrustStyle("inset(0 100% 0 0)"),this.isFullscreen=!1}return l.prototype.ionViewDidLoad=function(){var l=this;console.log("ionViewDidLoad GamePage"),this.loadGame(),this.events.subscribe("account:changed",function(n){setTimeout(function(){l.loadGame()},0)})},l.prototype.leaveRoom=function(){var l=this;io.socket.post("/api/v1/chat/leave",{room:this.room},function(){l.room=null,l.chatConnected=!1})},l.prototype.joinRoom=function(l){var n=this;console.log("join room000"),io.socket.post("/api/v1/chat/join",{room:l},function(){console.log("joined room "+l),n.room=l,n.chatConnected=!0,n.listening||(n.listening=!0,io.socket.on("message",function(l){l?(console.log("gotmsg",l),n.msgs.push(l)):console.log("why")}))})},l.prototype.ionViewDidEnter=function(){console.log(this.appState.account),this.chatcontent.scrollToBottom(1e3)},l.prototype.ionViewWillLeave=function(){console.log("view leaving")},l.prototype.ionViewWillUnload=function(){console.log("view unloaded")},l.prototype.loadGameServices=function(){var l=this;window.UnityProgress=function(n,u){var a=100-100*u;0==a&&(l.gameLoaded=!0),console.log("in ionc=",u,a),l.loadingStyle=l.sanitizer.bypassSecurityTrustStyle("inset(0 "+a+"% 0 0)")},window.addEventListener("room",function(n){n.detail.join?l.joinRoom(n.detail.room):l.room&&l.leaveRoom()})},l.prototype.loadGame=function(){if(this.appState.account&&!window.gameInstance){this.loadGameServices(),window.gameInstance=window.UnityLoader.instantiate("gameContainer","/game/Build/unitywebDemo.json",{onProgress:window.UnityProgress});document.getElementById("#canvas").tabIndex=1}else console.log("already loaded")},l.prototype.send=function(l){var n=this;if(13==l)if(this.chatConnected&&this.room){var u={username:this.appState.account.substring(0,5),text:this.msg};io.socket.post("/api/v1/chat/send",{data:u,room:this.room}),this.msg="",setTimeout(function(){n.chatcontent.scrollToBottom(300)},50)}else this.msg=""},l.prototype.goFull=function(l){void 0===l&&(l=!0);for(var n=document.getElementById("canvaswindow"),u=document.getElementById("canvasfull");n.childNodes.length>0;)u.appendChild(n.childNodes[0]);if(window.gameInstance.SetFullscreen(1),l){this.isFullscreen=!0;var a=setInterval(function(){if(console.log(1>=outerHeight-innerHeight),1<outerHeight-innerHeight){for(;u.childNodes.length>0;)n.appendChild(u.childNodes[0]);clearInterval(a)}},100)}},l.prototype.toggleChat=function(){this.showChat=!this.showChat,this.content.resize()},l}(),h=u(115),m=function(){return function(){}}(),f=u(187),v=u(188),b=u(189),y=u(190),w=u(191),Z=u(192),C=u(193),Y=u(194),j=u(195),I=u(10),S=u(76),k=u(75),z=u(198),F=u(55),P=u(1),U=u(123),L=u(15),q=u(12),G=u(41),M=u(57),T=u(46),V=u(3),x=u(6),B=u(9),E=u(35),N=u(54),R=u(4),D=u(116),H=u(22),W=u(8),O=u(17),A=u(196),X=u(74),$=u(197),J=u(20),K=u(26),Q=u(23),ll=u(122),nl=u(29),ul=d.X({encapsulation:2,styles:[],data:{}}),al=u(202),el=u(36),tl=u(203),ol=u(58),il=u(124),sl=u(201),cl=u(14),rl=u(56),dl=u(11),gl=u(79),_l=d.X({encapsulation:2,styles:[],data:{}}),pl=d.V("page-game",p,function(l){return d._19(0,[(l()(),d.Z(0,0,null,null,1,"page-game",[],null,null,null,r,_l)),d.Y(1,49152,null,0,p,[O.a,dl.a,_.a,nl.a,gl.a,g.c],null,null)],null,null)},{},{},[]),hl=u(117),ml=u(40);u.d(n,"GamePageModuleNgFactory",function(){return fl});var fl=d.W(m,[],function(l){return d._10([d._11(512,d.i,d.S,[[8,[f.a,v.a,b.a,y.a,w.a,Z.a,C.a,Y.a,j.a,pl]],[3,d.i],d.s]),d._11(4608,I.k,I.j,[d.r,[2,I.s]]),d._11(4608,cl.o,cl.o,[]),d._11(4608,cl.d,cl.d,[]),d._11(512,I.b,I.b,[]),d._11(512,cl.m,cl.m,[]),d._11(512,cl.e,cl.e,[]),d._11(512,cl.l,cl.l,[]),d._11(512,hl.a,hl.a,[]),d._11(512,h.a,h.a,[]),d._11(512,hl.b,hl.b,[]),d._11(512,m,m,[]),d._11(256,ml.a,p,[])])})}});